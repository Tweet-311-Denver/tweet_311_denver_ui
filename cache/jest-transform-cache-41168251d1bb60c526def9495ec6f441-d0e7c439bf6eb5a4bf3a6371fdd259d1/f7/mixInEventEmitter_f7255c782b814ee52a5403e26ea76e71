7181ee15c7a399fd4f7b35f6e8490107
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var EventEmitter = require("./EventEmitter");

var EventEmitterWithHolding = require("./EventEmitterWithHolding");

var EventHolder = require("./EventHolder");

var invariant = require('invariant');

var keyOf = require('fbjs/lib/keyOf');

var TYPES_KEY = keyOf({
  __types: true
});

function mixInEventEmitter(cls, types) {
  invariant(types, 'Must supply set of valid event types');
  var target = cls.prototype || cls;
  invariant(!target.__eventEmitter, 'An active emitter is already mixed in');
  var ctor = cls.constructor;

  if (ctor) {
    invariant(ctor === Object || ctor === Function, 'Mix EventEmitter into a class, not an instance');
  }

  if (target.hasOwnProperty(TYPES_KEY)) {
    (0, _extends2.default)(target.__types, types);
  } else if (target.__types) {
    target.__types = (0, _extends2.default)({}, target.__types, types);
  } else {
    target.__types = types;
  }

  (0, _extends2.default)(target, EventEmitterMixin);
}

var EventEmitterMixin = {
  emit: function emit(eventType, a, b, c, d, e, _) {
    return this.__getEventEmitter().emit(eventType, a, b, c, d, e, _);
  },
  emitAndHold: function emitAndHold(eventType, a, b, c, d, e, _) {
    return this.__getEventEmitter().emitAndHold(eventType, a, b, c, d, e, _);
  },
  addListener: function addListener(eventType, listener, context) {
    return this.__getEventEmitter().addListener(eventType, listener, context);
  },
  once: function once(eventType, listener, context) {
    return this.__getEventEmitter().once(eventType, listener, context);
  },
  addRetroactiveListener: function addRetroactiveListener(eventType, listener, context) {
    return this.__getEventEmitter().addRetroactiveListener(eventType, listener, context);
  },
  addListenerMap: function addListenerMap(listenerMap, context) {
    return this.__getEventEmitter().addListenerMap(listenerMap, context);
  },
  addRetroactiveListenerMap: function addRetroactiveListenerMap(listenerMap, context) {
    return this.__getEventEmitter().addListenerMap(listenerMap, context);
  },
  removeAllListeners: function removeAllListeners() {
    this.__getEventEmitter().removeAllListeners();
  },
  removeCurrentListener: function removeCurrentListener() {
    this.__getEventEmitter().removeCurrentListener();
  },
  releaseHeldEventType: function releaseHeldEventType(eventType) {
    this.__getEventEmitter().releaseHeldEventType(eventType);
  },
  __getEventEmitter: function __getEventEmitter() {
    if (!this.__eventEmitter) {
      var emitter = new EventEmitter();

      if (__DEV__) {
        var EventValidator = require("./EventValidator");

        emitter = EventValidator.addValidation(emitter, this.__types);
      }

      var holder = new EventHolder();
      this.__eventEmitter = new EventEmitterWithHolding(emitter, holder);
    }

    return this.__eventEmitter;
  }
};
module.exports = mixInEventEmitter;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1peEluRXZlbnRFbWl0dGVyLmpzIl0sIm5hbWVzIjpbIkV2ZW50RW1pdHRlciIsInJlcXVpcmUiLCJFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyIsIkV2ZW50SG9sZGVyIiwiaW52YXJpYW50Iiwia2V5T2YiLCJUWVBFU19LRVkiLCJfX3R5cGVzIiwibWl4SW5FdmVudEVtaXR0ZXIiLCJjbHMiLCJ0eXBlcyIsInRhcmdldCIsInByb3RvdHlwZSIsIl9fZXZlbnRFbWl0dGVyIiwiY3RvciIsImNvbnN0cnVjdG9yIiwiT2JqZWN0IiwiRnVuY3Rpb24iLCJoYXNPd25Qcm9wZXJ0eSIsIkV2ZW50RW1pdHRlck1peGluIiwiZW1pdCIsImV2ZW50VHlwZSIsImEiLCJiIiwiYyIsImQiLCJlIiwiXyIsIl9fZ2V0RXZlbnRFbWl0dGVyIiwiZW1pdEFuZEhvbGQiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyIiwiY29udGV4dCIsIm9uY2UiLCJhZGRSZXRyb2FjdGl2ZUxpc3RlbmVyIiwiYWRkTGlzdGVuZXJNYXAiLCJsaXN0ZW5lck1hcCIsImFkZFJldHJvYWN0aXZlTGlzdGVuZXJNYXAiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJyZW1vdmVDdXJyZW50TGlzdGVuZXIiLCJyZWxlYXNlSGVsZEV2ZW50VHlwZSIsImVtaXR0ZXIiLCJfX0RFVl9fIiwiRXZlbnRWYWxpZGF0b3IiLCJhZGRWYWxpZGF0aW9uIiwiaG9sZGVyIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBVUE7Ozs7OztBQUVBLElBQU1BLFlBQVksR0FBR0MsT0FBTyxrQkFBNUI7O0FBQ0EsSUFBTUMsdUJBQXVCLEdBQUdELE9BQU8sNkJBQXZDOztBQUNBLElBQU1FLFdBQVcsR0FBR0YsT0FBTyxpQkFBM0I7O0FBRUEsSUFBTUcsU0FBUyxHQUFHSCxPQUFPLENBQUMsV0FBRCxDQUF6Qjs7QUFDQSxJQUFNSSxLQUFLLEdBQUdKLE9BQU8sQ0FBQyxnQkFBRCxDQUFyQjs7QUFJQSxJQUFNSyxTQUFT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LEdBQWlCdkMsaUJBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZm9ybWF0XG4gKiBAZmxvd1xuICovXG5cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgRXZlbnRFbWl0dGVyID0gcmVxdWlyZSgnLi9FdmVudEVtaXR0ZXInKTtcbmNvbnN0IEV2ZW50RW1pdHRlcldpdGhIb2xkaW5nID0gcmVxdWlyZSgnLi9FdmVudEVtaXR0ZXJXaXRoSG9sZGluZycpO1xuY29uc3QgRXZlbnRIb2xkZXIgPSByZXF1aXJlKCcuL0V2ZW50SG9sZGVyJyk7XG5cbmNvbnN0IGludmFyaWFudCA9IHJlcXVpcmUoJ2ludmFyaWFudCcpO1xuY29uc3Qga2V5T2YgPSByZXF1aXJlKCdmYmpzL2xpYi9rZXlPZicpO1xuXG5pbXBvcnQgdHlwZSBFbWl0dGVyU3Vic2NyaXB0aW9uIGZyb20gJy4vRW1pdHRlclN1YnNjcmlwdGlvbic7XG5cbmNvbnN0IFRZUEVTX0tFWSA9IGtleU9mKHtfX3R5cGVzOiB0cnVlfSk7XG5cbi8qKlxuICogQVBJIHRvIHNldHVwIGFuIG9iamVjdCBvciBjb25zdHJ1Y3RvciB0byBiZSBhYmxlIHRvIGVtaXQgZGF0YSBldmVudHMuXG4gKlxuICogQGV4YW1wbGVcbiAqIGZ1bmN0aW9uIERvZygpIHsgLi4uZG9nIHN0dWZmLi4uIH1cbiAqIG1peEluRXZlbnRFbWl0dGVyKERvZywge2Jhcms6IHRydWV9KTtcbiAqXG4gKiB2YXIgcHVwcHkgPSBuZXcgRG9nKCk7XG4gKiBwdXBweS5hZGRMaXN0ZW5lcignYmFyaycsIGZ1bmN0aW9uICh2b2x1bWUpIHtcbiAqICAgY29uc29sZS5sb2coJ1B1cHB5JywgdGhpcywgJ2JhcmtlZCBhdCB2b2x1bWU6Jywgdm9sdW1lKTtcbiAqIH0pO1xuICogcHVwcHkuZW1pdCgnYmFyaycsICdxdWlldCcpO1xuICogLy8gUHVwcHkgPHB1cHB5PiBiYXJrZWQgYXQgdm9sdW1lOiBxdWlldFxuICpcbiAqXG4gKiAvLyBBIFwic2luZ2xldG9uXCIgb2JqZWN0IG1heSBhbHNvIGJlIGNvbW1pc3Npb25lZDpcbiAqXG4gKiB2YXIgU2luZ2xldG9uID0ge307XG4gKiBtaXhJbkV2ZW50RW1pdHRlcihTaW5nbGV0b24sIHtsb25lbHk6IHRydWV9KTtcbiAqIFNpbmdsZXRvbi5lbWl0KCdsb25lbHknLCB0cnVlKTtcbiAqL1xuZnVuY3Rpb24gbWl4SW5FdmVudEVtaXR0ZXIoY2xzOiBGdW5jdGlvbiB8IE9iamVjdCwgdHlwZXM6IE9iamVjdCkge1xuICBpbnZhcmlhbnQodHlwZXMsICdNdXN0IHN1cHBseSBzZXQgb2YgdmFsaWQgZXZlbnQgdHlwZXMnKTtcblxuICAvLyBJZiB0aGlzIGlzIGEgY29uc3RydWN0b3IsIHdyaXRlIHRvIHRoZSBwcm90b3R5cGUsIG90aGVyd2lzZSB3cml0ZSB0byB0aGVcbiAgLy8gc2luZ2xldG9uIG9iamVjdC5cbiAgY29uc3QgdGFyZ2V0ID0gY2xzLnByb3RvdHlwZSB8fCBjbHM7XG5cbiAgaW52YXJpYW50KCF0YXJnZXQuX19ldmVudEVtaXR0ZXIsICdBbiBhY3RpdmUgZW1pdHRlciBpcyBhbHJlYWR5IG1peGVkIGluJyk7XG5cbiAgY29uc3QgY3RvciA9IGNscy5jb25zdHJ1Y3RvcjtcbiAgaWYgKGN0b3IpIHtcbiAgICBpbnZhcmlhbnQoXG4gICAgICBjdG9yID09PSBPYmplY3QgfHwgY3RvciA9PT0gRnVuY3Rpb24sXG4gICAgICAnTWl4IEV2ZW50RW1pdHRlciBpbnRvIGEgY2xhc3MsIG5vdCBhbiBpbnN0YW5jZScsXG4gICAgKTtcbiAgfVxuXG4gIC8vIEtlZXAgdHJhY2sgb2YgdGhlIHByb3ZpZGVkIHR5cGVzLCB1bmlvbiB0aGUgdHlwZXMgaWYgdGhleSBhbHJlYWR5IGV4aXN0LFxuICAvLyB3aGljaCBhbGxvd3MgZm9yIHByb3RvdHlwZSBzdWJjbGFzc2VzIHRvIHByb3ZpZGUgbW9yZSB0eXBlcy5cbiAgaWYgKHRhcmdldC5oYXNPd25Qcm9wZXJ0eShUWVBFU19LRVkpKSB7XG4gICAgT2JqZWN0LmFzc2lnbih0YXJnZXQuX190eXBlcywgdHlwZXMpO1xuICB9IGVsc2UgaWYgKHRhcmdldC5fX3R5cGVzKSB7XG4gICAgdGFyZ2V0Ll9fdHlwZXMgPSBPYmplY3QuYXNzaWduKHt9LCB0YXJnZXQuX190eXBlcywgdHlwZXMpO1xuICB9IGVsc2Uge1xuICAgIHRhcmdldC5fX3R5cGVzID0gdHlwZXM7XG4gIH1cbiAgT2JqZWN0LmFzc2lnbih0YXJnZXQsIEV2ZW50RW1pdHRlck1peGluKTtcbn1cblxuY29uc3QgRXZlbnRFbWl0dGVyTWl4aW4gPSB7XG4gIGVtaXQ6IGZ1bmN0aW9uKGV2ZW50VHlwZSwgYSwgYiwgYywgZCwgZSwgXykge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkuZW1pdChldmVudFR5cGUsIGEsIGIsIGMsIGQsIGUsIF8pO1xuICB9LFxuXG4gIGVtaXRBbmRIb2xkOiBmdW5jdGlvbihldmVudFR5cGUsIGEsIGIsIGMsIGQsIGUsIF8pIHtcbiAgICByZXR1cm4gdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLmVtaXRBbmRIb2xkKGV2ZW50VHlwZSwgYSwgYiwgYywgZCwgZSwgXyk7XG4gIH0sXG5cbiAgYWRkTGlzdGVuZXI6IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIsIGNvbnRleHQpOiBFbWl0dGVyU3Vic2NyaXB0aW9uIHtcbiAgICByZXR1cm4gdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLmFkZExpc3RlbmVyKGV2ZW50VHlwZSwgbGlzdGVuZXIsIGNvbnRleHQpO1xuICB9LFxuXG4gIG9uY2U6IGZ1bmN0aW9uKGV2ZW50VHlwZSwgbGlzdGVuZXIsIGNvbnRleHQpIHtcbiAgICByZXR1cm4gdGhpcy5fX2dldEV2ZW50RW1pdHRlcigpLm9uY2UoZXZlbnRUeXBlLCBsaXN0ZW5lciwgY29udGV4dCk7XG4gIH0sXG5cbiAgYWRkUmV0cm9hY3RpdmVMaXN0ZW5lcjogZnVuY3Rpb24oZXZlbnRUeXBlLCBsaXN0ZW5lciwgY29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkuYWRkUmV0cm9hY3RpdmVMaXN0ZW5lcihcbiAgICAgIGV2ZW50VHlwZSxcbiAgICAgIGxpc3RlbmVyLFxuICAgICAgY29udGV4dCxcbiAgICApO1xuICB9LFxuXG4gIGFkZExpc3RlbmVyTWFwOiBmdW5jdGlvbihsaXN0ZW5lck1hcCwgY29udGV4dCkge1xuICAgIHJldHVybiB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkuYWRkTGlzdGVuZXJNYXAobGlzdGVuZXJNYXAsIGNvbnRleHQpO1xuICB9LFxuXG4gIGFkZFJldHJvYWN0aXZlTGlzdGVuZXJNYXA6IGZ1bmN0aW9uKGxpc3RlbmVyTWFwLCBjb250ZXh0KSB7XG4gICAgcmV0dXJuIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5hZGRMaXN0ZW5lck1hcChsaXN0ZW5lck1hcCwgY29udGV4dCk7XG4gIH0sXG5cbiAgcmVtb3ZlQWxsTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gIH0sXG5cbiAgcmVtb3ZlQ3VycmVudExpc3RlbmVyOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9fZ2V0RXZlbnRFbWl0dGVyKCkucmVtb3ZlQ3VycmVudExpc3RlbmVyKCk7XG4gIH0sXG5cbiAgcmVsZWFzZUhlbGRFdmVudFR5cGU6IGZ1bmN0aW9uKGV2ZW50VHlwZSkge1xuICAgIHRoaXMuX19nZXRFdmVudEVtaXR0ZXIoKS5yZWxlYXNlSGVsZEV2ZW50VHlwZShldmVudFR5cGUpO1xuICB9LFxuXG4gIF9fZ2V0RXZlbnRFbWl0dGVyOiBmdW5jdGlvbigpIHtcbiAgICBpZiAoIXRoaXMuX19ldmVudEVtaXR0ZXIpIHtcbiAgICAgIGxldCBlbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgICAgaWYgKF9fREVWX18pIHtcbiAgICAgICAgY29uc3QgRXZlbnRWYWxpZGF0b3IgPSByZXF1aXJlKCcuL0V2ZW50VmFsaWRhdG9yJyk7XG4gICAgICAgIGVtaXR0ZXIgPSBFdmVudFZhbGlkYXRvci5hZGRWYWxpZGF0aW9uKGVtaXR0ZXIsIHRoaXMuX190eXBlcyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGhvbGRlciA9IG5ldyBFdmVudEhvbGRlcigpO1xuICAgICAgdGhpcy5fX2V2ZW50RW1pdHRlciA9IG5ldyBFdmVudEVtaXR0ZXJXaXRoSG9sZGluZyhlbWl0dGVyLCBob2xkZXIpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fX2V2ZW50RW1pdHRlcjtcbiAgfSxcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbWl4SW5FdmVudEVtaXR0ZXI7XG4iXX0=